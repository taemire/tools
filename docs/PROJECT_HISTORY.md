# 프로젝트 히스토리 (Project History)

이 문서는 `tools` 프로젝트의 주요 작업, 의사결정, 설계 변경 사항을 시간순으로 기록합니다.

---

## 2025-12-25: pdf_analyzer 목차 자동 감지 기능 구현

### 배경
- **이슈**: `md2pdf_v2.bat`의 `SKIP_PAGES`가 3으로 하드코딩되어 있어, 목차가 정확히 2페이지가 아닌 경우 본문 섹션 페이지 번호 계산에 오류 발생
- **영향**:
  - 목차가 1페이지인 경우: 본문 1페이지(전체 3p)의 섹션을 인식하지 못하고 건너뜀
  - 목차가 3페이지 이상인 경우: 목차 내용을 본문 섹션으로 오인할 위험

### 해결 방안
첫 번째 섹션을 찾아 본문 시작점을 자동으로 판단하는 방식으로 변경:

1. **pdf_analyzer 개선**:
   - `detectTocEndPage()` 함수 추가: 페이지 2부터 스캔하여 첫 번째 섹션 제목이 등장하는 페이지를 찾음
   - 본문 시작 페이지 - 1 = 목차 끝 페이지로 계산
   - `-skip` 파라미터: 0 또는 -1이면 자동 감지, 양수이면 수동 지정
   - 감지 실패 시 기본값 3 사용 (현재 동작 유지)

2. **md2pdf_v2.bat 수정**:
   - `SKIP_PAGES` 기본값을 3에서 0으로 변경하여 자동 감지 모드 기본 활성화
   - Help 메시지에 자동 감지 기능 설명 추가

### 테스트 결과
- **자동 감지 모드** (`-skip 0`):
  - PDF 37페이지 문서에서 첫 섹션 '소개'를 페이지 2에서 발견
  - 목차 끝을 페이지 1로 정확히 계산
  - 모든 섹션의 페이지 번호 정확히 추출 ✅

- **수동 지정 모드** (`-skip 3`):
  - 지정된 값대로 페이지 4부터 검색 시작
  - 기존 동작 그대로 유지 ✅

### 엣지 케이스 처리
- 첫 섹션을 찾지 못한 경우: 기본값 3 사용 (표지 1p + 목차 2p)
- 페이지 2에서 이미 섹션 발견: 목차가 0페이지로 판단 (표지만 있음)

### 관련 파일
- `md2html_v2/cmd/pdf_analyzer/main.go`: 자동 감지 로직 구현
- `md2html_v2/md2pdf_v2.bat`: 기본값 변경 및 Help 메시지 업데이트
- `docs/ISSUES.md`: 이슈 상태 업데이트 예정

---

## 2025-12-20: tools 저장소 초기 설정

### 배경
여러 프로젝트(`tkcli`, `codesign_service` 등)에서 사용되는 공통 도구들이 각 저장소에 흩어져 있어 관리가 어려웠음.

### 작업 내용
1. **저장소 통합**: 공통 도구들을 `tools` 저장소로 통합
2. **도구 정리**:
   - `html2pdf`: CDP 로그 노이즈 억제 적용
   - `md2html`: Markdown → HTML 변환기 및 템플릿
   - `check_version.bat`: Git 히스토리 및 태그 조회 스크립트
   - `mp4towebp.bat`: FFmpeg 자동 다운로드 및 WebP 변환 스크립트
3. **문서화**: CHANGELOG, ISSUES, 규칙 문서 작성

### 의사결정
- 각 프로젝트의 `build.bat`에서 `tools` 저장소의 도구를 참조하도록 변경
- 도구 버전 관리는 Git 태그로 수행
